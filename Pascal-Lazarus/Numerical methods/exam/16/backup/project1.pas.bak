{За допомогою схеми з вибором головного елемента обчислити корені системи лінійних рівнянь
252x0 + 114x1 + 32x2 + 36x3 + 67x4  = 7297
92x0 + 255x1 + 0x2 + 74x3 + 84x4  = 5448
19x0 + 63x1 + 217x2 + 49x3 + 83x4  = 5993
113x0 + 62x1 + 28x2 + 283x3 + 78x4  = 6855
74x0 + 9x1 + 8x2 + 109x3 + 205x4  = 6382}
uses crt;
type
   Tmas=array[1..20] of real;
   Tmatr=array[1..20] of Tmas;
procedure Per(k,n:integer;var a:Tmatr; var b:Tmas);
var i,j:integer;z:real;
begin
   z:=a[k,k];i:=k;//если главный элемент строки (a[k,k])=0, z=0; запоминаем эту строку
                                            ///(i:=k;)
   for j:=k+1 to n do //от следующей стороки до конца ищем самый большой элемент в том столбце, где 0
       if abs(a[j,k])>z then //обычный поиск максимального
          begin
            z:=a[j,k];
            i:=j;
          end;

       if i>k then //если нашли больше начального
          begin
            for j:=k to n do //то делаем обмен элементами между строкой с нолем и
               begin    //строкой с максимальным элементом в столбце с нолем
                 z:=a[i,j];a[i,j]:=a[k,j];a[k,j]:=z;
               end;
            z:=b[i];b[i]:=b[k];b[k]:=z; //обмениваем свободные члены
          end;

     end;
var a:Tmatr; //матрица системы
    b:Tmas;   //массив свободных членов
    x:Tmas;   //массив корней системы
    n,i,j,k:integer; //счетчики циклов
    z,r,g:real;  //вспомогательные переменные при расчетах
begin
A[1, 1] := 154; A[1, 2] := 79;  A[1, 3] := 1;   A[1, 4] := 58;  A[1, 5] := 12;
A[2, 1] := 22;  A[2, 2] := 188; A[2, 3] := 86;  A[2, 4] := 46;  A[2, 5] := 31;
A[3, 1] := 9;   A[3, 2] := 23;  A[3, 3] := 176; A[3, 4] := 82;  A[3, 5] := 58;
A[4, 1] := 30;  A[4, 2] := 75;  A[4, 3] := 99;  A[4, 4] := 267; A[4, 5] := 62;
A[5, 1] := 40;  A[5, 2] := 55;  A[5, 3] := 15;  A[5, 4] := 72;  A[5, 5] := 185;
A[1, 6] := 882; A[2, 6] := 1214;A[3, 6] := 906; A[4, 6] := 1750;A[5, 6] := 988;
{write('Введите количество уравнений n=');
readln(n);
writeln('Введите коэффициенты системы и свободные члены');
for i:=1 to n do
for j:=1 to n+1 do
read(A[i,j]);}  //вводим в строку через пробел коэффициенты и свободный член первого уравнения, жмем
                    //Enter,
                   //вводим следующую строку и так до конца
{writeln('Матрица коэффициентов и свободных членов'); //выводим матрицу системы
for i:=1 to n do
  begin
    for j:=1 to n+1 do
    write(A[i,j]:6:2);
    writeln;
  end;  }
//Прямой ход Гаусса, преобразуем квадратную матрицу коэффициентов в треугольную типа
//2,35 -5,36 4,56 16,25
//0,00 -3,25 7,26 25,39
//0,00 0,00 2,35 59,23  //здесь потом найдем 3-ий корень (59,23/2,35), а от него обратным ходом остальные
n:=5;
for i:=1 to n do
b[i]:=a[i,n+1];  //присваиваем значения массиву свободных членов (последний столбец матрицы)
for k:=1 to n do  //начинаем с первой строки
     begin
       if a[k,k]=0 then Per(k,n,a,b);}//добавлена процедура
       for j:=k+1 to n do //идем по строке выше главной диагонали до конца
          begin
            r:=a[j,k]/a[k,k]; //вычисляем коэффициент приведения первых коэффициентов, чтобы они были
                                    //равны и при вычитании давали 0 (освобождаемся от очередного неизвестного),
                                    //например
                                    //1-е ур. 2х1+3х1-4х3=12
                                     //2-е ур -3х1+2х2+2х3=25
                                     //r= -3/2, тогда 2х1*-3/2=-3х1
                                     //вычтем из ур.2-ур.1, х1 исчезнет
           for i:=k to n do
               begin
                 a[j,i]:=a[j,i]-r*a[k,i]; //сейчас умножив все первое урававнение на -3/2,  вычитаем из первого
              end;                         //уравнения второе
           b[j]:=b[j]-r*b[k];             //и свободнгые члены
        end;
     end;
   //система будет 1.    2х1+3х1-4х3=12
   //                         2.   0х1+(2-(3*-3/2))х2 +(2+(4*-3/2)=25-12*(-3/2)
//Обратный ход Гаусса, находим корни
for k:=n downto 1 do //от последней строки к первой
     begin
       r:=0;
       for j:=k+1 to n do //в строке от главной диагонали вправо (где не ноли)
         begin
           g:=a[k,j]*x[j]; //умножаем коэффициенты на  известные уже корни
           r:=r+g;         //суммируем
         end;
      x[k]:=(b[k]-r)/a[k,k];  //из преобразованного прямым ходом свободного члена вычитаем полученную
                                      //суммму и делим на первый коэффициент (который на главной диагонали)
     end;
writeln('roots'); //выводим результат
for i:=1 to n do
write('x[',i,']=',x[i]:0:2,'   ');
readln;
end.
