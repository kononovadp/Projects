Microsoft (R) Macro Assembler Version 5.00                  4/13/15 16:51:09
                                                             Page     1-1


       1				;Программа использует упрошенные директ
					ивы сегментации  
       2				;(в отладчике видны команды только из п
					ервого сегмента кодов) 
       3				.model small 
       4 0000				.data 
       5				Node struc ;шаблон структуры 
       6 0000  0004[			namex db 4 dup (0ffh)  
       7	   FF			
       8			 ]	
       9				
      10 0004  0002[			field1 dw 2 dup (3231h) 
      11	   3231			
      12			 ]	
      13				
      14 0008				node ends ;конец объџвлениџ шаблона стр
					уктуры 
      15 0000				Data1 segment ;первый сегмент данных (н
					еобходим для заданиџ 1) 
      16				;I_struc db 8 ;при попытке задействоват
					ь этот байт в командах увеличения смеще
					ния адреса (add bx,8) получались не те 
					результаты, поэ
      17				;a dw 3131h ;переменная используется дл
					я более лучшей наглядности, чтобы показ
					ать границу между структурами 
      18				;Структуры: 
      19 0000  0004[			A0 Node <> ; 
      20	   FF			
      21			 ]	
      22 0004  0002[			
      23	   3231			
      24			 ]	
      25				
      26 0008  0002[			A1 Node 2 dup (<>) 
      27	0004[			
      28	    FF			
      29			]	
      30	0002[			
      31	    3231		
      32			]	
      33			 ]	
      34				
      35 0018  0004[			A2 Node 4 dup (<>)  
      36	0004[			
      37	    FF			
      38			]	
      39	0002[			
      40	    3231		
      41			]	
      42			 ]	
      43				
      44 0038  0008[			A3 Node 8 dup (<>)  
      45	0004[			
Microsoft (R) Macro Assembler Version 5.00                  4/13/15 16:51:09
                                                             Page     1-2


      46	    FF			
      47			]	
      48	0002[			
      49	    3231		
      50			]	
      51			 ]	
      52				
      53				;b dw 3232h ;переменная используется дл
					я более лучшей наглядности, чтобы показ
					ать границу между структурами 
      54 0078				Data1 ends ;конец объџвлениџ первого се
					гмента данных 
      55 0000				Data2 segment ;второй сегмент данных (н
					еобходим длџ заданиџ 2) 
      56				;Структуры 
      57 0000  0004[			B0 Node <>  
      58	   FF			
      59			 ]	
      60 0004  0002[			
      61	   3231			
      62			 ]	
      63				
      64 0008  0002[			B1 Node 2 dup (<>) 
      65	0004[			
      66	    FF			
      67			]	
      68	0002[			
      69	    3231		
      70			]	
      71			 ]	
      72				
      73 0018  0004[			B2 Node 4 dup (<>) 
      74	0004[			
      75	    FF			
      76			]	
      77	0002[			
      78	    3231		
      79			]	
      80			 ]	
      81				
      82 0038  0008[			B3 Node 8 dup (<>) 
      83	0004[			
      84	    FF			
      85			]	
      86	0002[			
      87	    3231		
      88			]	
      89			 ]	
      90				
      91 0078				Data2 ends ;конец объџвлениџ второго се
					гмента данных 
      92 0000				.code 
      93 0000				code1: ; первый сегмент кодов (перваџ ч
					асть лабораторной работы) 
Microsoft (R) Macro Assembler Version 5.00                  4/13/15 16:51:09
                                                             Page     1-3


      94				;помещаем смещение элементов структуры 
					A1 в поле field1 массива структур A0 
      95 0000  B8 ---- R			mov	ax,data1 ;помещаем в ax
					 исходные данные о структурах сегмента 
					Data1 
      96 0003  8E D8				mov	ds,ax ;эти данные должн
					ы быть в сегментном регистре ds 
      97 0005  33 C0				xor	ax,ax ;обнуление ax  
      98 0007  B9 0002				mov	cx,length A1 ;помещаем 
					в счетчик размер структуры, из которой 
					будем перемещать элементы 
      99 000A  BE 0000				mov	si,0 ;обнуляем индексны
					й регистр  
     100 000D  BB 0008 R			mov bx, offset A1 ;помещаем адр
					еса смещений элементов структуры в bx 
     101 0010					CA0: 
     102 0010  89 9C 0004 R			mov field1.A0[si],bx ;помещаем 
					в массив целевой структуры необходимую 
					структуру 
1.ASM(36): warning A4057: Illegal size for operand
     103 0014  83 C3 08				add bx,8 ;сдвиг по структуре на
					 следующий элемент 
     104 0017  83 C6 02				add si,2 ;сдвиг индекса 
     105 001A  E2 F4				loop CA0 
     106				;--------------------------------------
					------------------------------------
						 
     107				;помещаем смещение элементов структуры 
					A2 в поле field1 массива структур A1
						 
     108 001C  B9 0004				mov	cx,length A2 ;помещаем 
					в счетчик размер структуры, из которой 
					будем перемещать элементы 
     109 001F  BE 0000				mov	si,0 ;обнуляем индексны
					й регистр  
     110 0022  BB 0018 R			mov bx, offset A2 ;помещаем сме
					щения элементов структуры в bx 
     111 0025					CA1: 
     112 0025  89 9C 000C R			mov field1.A1[si],bx ;помещаем 
					в массив целевой структуры необходимую 
					структуру 
1.ASM(46): warning A4057: Illegal size for operand
     113 0029  83 C3 08				add bx,8 ;сдвига по структуре н
					а следующий элемент 
     114 002C  83 F9 03				cmp cx,3 ;когда счетчик на трет
					ьем элементе, нужно сдвинуться на 4 эле
					мента вперед, чтобы попасть в поле fiel
					d1 
     115 002F  74 02				je @1 ;если cx = 3, то выполняе
					тся сдвиг на 4 элемента, чтобы попасть 
					в поле field1 
     116 0031  75 03				jne @2 ; в остальных случаях ин
					декс сдвигается на 2 
     117 0033  83 C6 04				@1: add si,4 ;сдвиг индекса на 
Microsoft (R) Macro Assembler Version 5.00                  4/13/15 16:51:09
                                                             Page     1-4


					4 
     118 0036  83 C6 02				@2: add si,2 ;сдвиг индекса на 
					2 
     119 0039  E2 EA				loop CA1 
     120				;--------------------------------------
					------------------------------------
						 
     121				;помещаем смещение элементов структуры 
					A3 в поле field1 массива структур A2 
     122				;(получилось не совсем красиво, возможн
					о есть более грамотный вариант с меньши
					м количеством команд!) 
     123 003B  B9 0004				mov	cx,4 ;в одном цикле обр
					абатываем половину элементов структуры 
     124 003E  BE 0000				mov	si,0 ;обнуляем индексны
					й регистр  
     125 0041  BB 0038 R			mov bx, offset A3 ;помещаем сме
					щение элементов структуры в bx 
     126 0044					CA2: 
     127 0044  89 9C 001C R			mov field1.A2[si],bx ;помещаем 
					в массив целевой структуры необходимую 
					структуру 
1.ASM(61): warning A4057: Illegal size for operand
     128 0048  83 C3 08				add bx,8 ;сдвигаемсџ по структу
					ре на следующий элемент 
     129 004B  83 F9 03				cmp cx,3 ;когда счетчик на трет
					ьем элементе, нужно сдвинуться на 4 эле
					мента вперед, чтобы попасть в поле fiel
					d1 
     130 004E  74 02				je @3 ;если cx = 3, то выполняе
					тся сдвиг на 4 элемента, чтобы попасть 
					в поле field1 
     131 0050  75 03				jne @4 ; в остальных случаях ин
					декс сдвигается на 2 
     132 0052  83 C6 04				@3: add si,4 ;сдвиг индекса на 
					4 
     133 0055  83 C6 02				@4: add si,2 ;сдвиг индекса на 
					2 
     134 0058  E2 EA				loop CA2 
     135 005A  83 C6 04				add si,4 ;переход на 4 элемента
					, чтобы попасть в поле field1 
     136 005D  B9 0004				mov cx,4 ;во втором цикле обраб
					атывается 4 остальных элемента 
     137 0060					CA2_1: 
     138 0060  89 9C 001C R			mov field1.A2[si],bx ;помещаем 
					в массив целевой структуры необходимую 
					структуру 
1.ASM(72): warning A4057: Illegal size for operand
     139 0064  83 C3 08				add bx,8 ;сдвигаемсџ по структу
					ре на следующий элемент 
     140 0067  83 F9 03				cmp cx,3 ;когда счетчик на трет
					ьем элементе, нужно сдвинуться на 4 эле
					мента вперед, чтобы попасть в поле fiel
					d1 
Microsoft (R) Macro Assembler Version 5.00                  4/13/15 16:51:09
                                                             Page     1-5


     141 006A  74 02				je @5 ;если cx = 3, то выполняе
					тся сдвиг на 4 элемента, чтобы попасть 
					в поле field1 
     142 006C  75 03				jne @6 ; в остальных случаях ин
					декс сдвигается на 2 
     143 006E  83 C6 04				@5: add si,4 ;сдвиг индекса на 
					4 
     144 0071  83 C6 02				@6: add si,2 ;сдвиг индекса на 
					2 
     145 0074  E2 EA				loop CA2_1 
     146 0076					exit: ;завершение программы, та
					к как запуск следующих сегментов кодов 
					и данных не поддерживается выбранной мн
					ой структурой программ
     147 0076  B8 4C00				mov ax, 4c00h 
     148 0079  CD 21				int 21h 
     149 007B					end code1 ; конец первого сегме
					нта кодов 
Microsoft (R) Macro Assembler Version 5.00                  4/13/15 16:51:09
                                                             Symbols-1


Structures and Records:

                N a m e                 Width   # fields
                                        Shift   Width   Mask    Initial

NODE . . . . . . . . . . . . . .  	0008	0002
  NAMEX  . . . . . . . . . . . .  	0000
  FIELD1 . . . . . . . . . . . .  	0004

Segments and Groups:

                N a m e         	Length	 Align	Combine Class

DATA1  . . . . . . . . . . . . .  	0078	PARA	NONE	
DATA2  . . . . . . . . . . . . .  	0078	PARA	NONE	
DGROUP . . . . . . . . . . . . .  	GROUP
  _DATA  . . . . . . . . . . . .  	0000	WORD	PUBLIC	'DATA'
_TEXT  . . . . . . . . . . . . .  	007B	WORD	PUBLIC	'CODE'

Symbols:            

                N a m e         	Type	 Value	 Attr

A0 . . . . . . . . . . . . . . .  	L QWORD	0000	DATA1
A1 . . . . . . . . . . . . . . .  	L QWORD	0008	DATA1	Length = 0002
A2 . . . . . . . . . . . . . . .  	L QWORD	0018	DATA1	Length = 0004
A3 . . . . . . . . . . . . . . .  	L QWORD	0038	DATA1	Length = 0008

B0 . . . . . . . . . . . . . . .  	L QWORD	0000	DATA2
B1 . . . . . . . . . . . . . . .  	L QWORD	0008	DATA2	Length = 0002
B2 . . . . . . . . . . . . . . .  	L QWORD	0018	DATA2	Length = 0004
B3 . . . . . . . . . . . . . . .  	L QWORD	0038	DATA2	Length = 0008

CA0  . . . . . . . . . . . . . .  	L NEAR	0010	_TEXT
CA1  . . . . . . . . . . . . . .  	L NEAR	0025	_TEXT
CA2  . . . . . . . . . . . . . .  	L NEAR	0044	_TEXT
CA2_1  . . . . . . . . . . . . .  	L NEAR	0060	_TEXT
CODE1  . . . . . . . . . . . . .  	L NEAR	0000	_TEXT

EXIT . . . . . . . . . . . . . .  	L NEAR	0076	_TEXT

@1 . . . . . . . . . . . . . . .  	L NEAR	0033	_TEXT
@2 . . . . . . . . . . . . . . .  	L NEAR	0036	_TEXT
@3 . . . . . . . . . . . . . . .  	L NEAR	0052	_TEXT
@4 . . . . . . . . . . . . . . .  	L NEAR	0055	_TEXT
@5 . . . . . . . . . . . . . . .  	L NEAR	006E	_TEXT
@6 . . . . . . . . . . . . . . .  	L NEAR	0071	_TEXT
@CODE  . . . . . . . . . . . . .  	TEXT  _TEXT		
@CODESIZE  . . . . . . . . . . .  	TEXT  0		
@DATASIZE  . . . . . . . . . . .  	TEXT  0		
@FILENAME  . . . . . . . . . . .  	TEXT  1		

Microsoft (R) Macro Assembler Version 5.00                  4/13/15 16:51:09
                                                             Symbols-2



     83 Source  Lines
     83 Total   Lines
     38 Symbols

  48502 + 418810 Bytes symbol space free

      4 Warning Errors
      0 Severe  Errors
